<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QuickPress | Checkout</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="../assets/ui.css">
</head>

<body>

<div class="container">
  <h2>ðŸ§º Checkout</h2>

  <p><b>City:</b> <span id="cityName"></span></p>
  <p><b>Total Amount:</b> â‚¹299</p>

  <button onclick="placeOrder()">Place Order</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
import { createOrderWithAutoMapping } from "../assets/order-mapping.js";

/* FIREBASE CONFIG */
const app = initializeApp({
  apiKey: "AIzaSyCqrOXjuQIgfSKS7_YBb_ft-Z6ubsGpAqs",
  authDomain: "quickpress-e486d.firebaseapp.com",
  projectId: "quickpress-e486d"
});

const auth = getAuth(app);
const db = getFirestore(app);

/* SHOW CITY */
document.getElementById("cityName").innerText =
  localStorage.getItem("selectedCity") || "Not selected";

/* PLACE ORDER */
window.placeOrder = async ()=>{
  try{
    await createOrderWithAutoMapping({
      cityId: localStorage.getItem("selectedCity"),
      totalAmount: 299
    });
    alert("âœ… Order placed successfully");
    location.href = "order-tracking.html";
  }catch(e){
    alert(e);
  }
};
</script>

</body>
</html>
